{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["function extractValue(reg, str) {\n    const matches = str.match(reg);\n    return matches && matches[0];\n}\n\nfunction getVendorRenderer(gl) {\n\n    const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');\n    if (!debugInfo) {\n\n        return null;\n\n    }\n\n    const vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);\n    const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);\n\n    return { vendor, renderer };\n\n}\n\nfunction parseGpuInfo(vendor, renderer) {\n\n    // Full card description and webGL layer (if present)\n    const layer = extractValue(/(ANGLE)/g, renderer);\n    const name = extractValue(/(NVIDIA|AMD|Intel)\\D*\\d*\\S*/, renderer) || renderer;\n\n    return {\n\n        name: name.trim(),\n\n        unmasked: {\n            vendor,\n            renderer,\n        },\n\n        integrated: /Intel/i.test(name),\n        layer,\n\n    };\n\n}\n\nfunction getBasicInfo(glOrRenderer = null, vendor = null) {\n\n    glOrRenderer = glOrRenderer || document.createElement('canvas').getContext('webgl');\n\n    let renderer = null;\n    if (typeof glOrRenderer === 'string') {\n\n        renderer = glOrRenderer;\n\n    } else {\n\n        const vr = getVendorRenderer(glOrRenderer);\n        if (!vr) return null;\n\n        renderer = vr.renderer;\n        vendor = vr.vendor;\n\n    }\n\n    return parseGpuInfo(vendor, renderer);\n\n}\n\nfunction strToCompareArray(str) {\n\n    return str.split(/\\W+/g).map(c => c.trim().toLowerCase()).filter(c => c.length > 1);\n\n}\n\nfunction compareStr(a, b) {\n\n    if (typeof a === 'string') a = strToCompareArray(a);\n    if (typeof b === 'string') b = strToCompareArray(b);\n\n    let tot = 0;\n    for (let i = 0, l = a.length; i < l; i++) {\n\n        if (b.includes(a[i])) tot++;\n\n    }\n\n    return tot / Math.min(a.length, b.length);\n\n}\n\nfunction rendererToGpu(database, renderer) {\n\n    const gpuNames = Object.keys(database);\n    let gpuName = null;\n    let compare = -Infinity;\n\n    const numMatches = /\\w*\\d\\d\\d+\\w*/.exec(renderer);\n    let numRegexp = null;\n    if (numMatches) {\n        numRegexp = new RegExp(`(^|\\\\W)${ numMatches[0] }(\\\\W|$)`, 'i');\n    }\n\n    const gpuArr = strToCompareArray(renderer);\n    for (let i = 0, l = gpuNames.length; i < l; i++) {\n\n        const name = gpuNames[i];\n        if (numRegexp && !numRegexp.test(name)) continue;\n        if (!numRegexp && /\\d\\d\\d+/.test(name)) continue;\n\n        const similarity = compareStr(name, gpuArr);\n        if (similarity > compare) {\n\n            compare = similarity;\n            gpuName = gpuNames[i];\n\n        }\n\n    }\n\n    return compare > 0.5 ? database[gpuName] : null;\n\n}\n\nfunction getDetailedInfo(database, glOrRenderer = null) {\n\n    glOrRenderer = glOrRenderer || document.createElement('canvas').getContext('webgl');\n\n    let renderer = null;\n    if (typeof glOrRenderer === 'string') {\n\n        renderer = glOrRenderer;\n\n    } else {\n\n        const vr = getVendorRenderer(glOrRenderer);\n        if (!vr) return null;\n\n        renderer = vr.renderer;\n\n    }\n\n    return rendererToGpu(database, renderer);\n\n}\n\nexport { getDetailedInfo, getBasicInfo };\n"],"names":[],"mappings":"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"}